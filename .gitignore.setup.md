# .gitignore 配置说明

## 概述

为 Next-DrawIO Monorepo 项目配置了完整的 .gitignore 文件，确保不同层级的文件忽略规则合理分配。

## 文件结构

```
next-drawio/
├── .gitignore              # 根目录 - 主要忽略规则
├── next-drawio-core/
│   └── .gitignore          # 核心库 - 特定忽略规则
├── next-drawio-react/
│   └── .gitignore          # React 项目 - Next.js 特定规则
└── next-drawio-vue/
    └── .gitignore          # Vue 项目 - Vite 特定规则
```

## 各级别配置说明

### 1. 根目录 `.gitignore`

**职责：** 全局忽略规则，覆盖整个 monorepo

**主要忽略内容：**
- 依赖目录 (`node_modules/`)
- 构建输出 (`dist/`, `build/`, `.next/`)
- 锁文件 (`pnpm-lock.yaml`, `package-lock.json`)
- 日志文件 (`*.log`)
- 操作系统文件 (`.DS_Store`, `Thumbs.db`)
- IDE 配置 (`.vscode/`, `.idea/`)
- 测试覆盖率 (`coverage/`)
- 环境变量文件 (`.env*`)
- 临时文件 (`tmp/`, `*.cache`)

**特殊性：**
- 包含 Monorepo 特定的忽略规则
- 覆盖所有子项目的通用忽略需求

### 2. `next-drawio-core/.gitignore`

**职责：** 核心库特定的忽略规则

**主要忽略内容：**
- 构建产物 (`dist/`, `*.tsbuildinfo`)
- 测试覆盖率报告
- 核心库特定的临时文件

**特殊性：**
- 专注于库包的构建和测试输出
- 不包含框架特定的忽略规则

### 3. `next-drawio-react/.gitignore`

**职责：** React/Next.js 项目特定规则

**主要忽略内容：**
- Next.js 构建输出 (`.next/`, `out/`)
- Storybook 静态输出 (`storybook-static/`)
- Next.js 特定文件 (`next-env.d.ts`)

**特殊性：**
- 包含 Next.js 框架的特定忽略规则
- 包含 Storybook 构建输出

### 4. `next-drawio-vue/.gitignore`

**职责：** Vue/Vite 项目特定规则

**主要忽略内容：**
- Vite 构建输出 (`dist/`, `dist-ssr/`)
- Vite 特定的本地文件 (`*.local`)

**特殊性：**
- 专注于 Vite 构建系统的输出
- 不包含 Next.js 相关规则

## 设计原则

### 1. **分层管理**
- 根目录处理通用规则
- 子目录处理框架特定规则
- 避免重复配置

### 2. **最小权限**
- 每个子项目只配置自己特有的忽略规则
- 通用规则统一在根目录管理

### 3. **框架适配**
- React 项目：Next.js + Storybook
- Vue 项目：Vite + 标准构建
- 核心库：纯 TypeScript 库配置

### 4. **开发工具支持**
- 覆盖主流编辑器和 IDE
- 包含包管理器临时文件
- 支持各种测试工具

## 使用建议

### 新增文件类型时的处理原则

1. **通用文件类型** → 添加到根目录 `.gitignore`
2. **框架特定文件** → 添加到对应子项目 `.gitignore`
3. **构建产物** → 优先添加到具体项目的 `.gitignore`

### 常见场景处理

```bash
# 新增 IDE 支持
echo ".vscode/" >> .gitignore

# 新增构建输出目录
echo "custom-build/" >> next-drawio-react/.gitignore

# 新增临时文件格式
echo "*.temp" >> .gitignore
```

## 验证和测试

### 检查 Git 忽略状态

```bash
# 查看被忽略的文件
git status --ignored

# 检查特定文件是否被忽略
git check-ignore -v path/to/file

# 调试 gitignore 规则
git status --ignored --porcelain
```

### 常用命令

```bash
# 强制添加被忽略的文件
git add -f file.log

# 清理不必要的文件（小心使用）
git clean -fdX
```

## 维护指南

### 定期检查项目

1. **新依赖**：检查是否需要新增忽略规则
2. **新工具**：添加工具特定的临时文件和目录
3. **构建配置**：更新构建输出的忽略规则

### 团队协作

1. **统一配置**：确保团队成员使用相同的忽略规则
2. **文档更新**：新增特殊忽略规则时更新此文档
3. **代码审查**：PR 时检查是否有敏感文件被意外提交

## 故障排除

### 文件没有被忽略

1. 检查文件路径是否匹配规则
2. 确认规则在正确的 `.gitignore` 文件中
3. 检查规则语法是否正确
4. 确认文件之前没有被 Git 跟踪

### 规则冲突

1. 根目录规则优先级最高
2. 子项目规则可以补充但不能覆盖根目录规则
3. 使用 `!` 前缀来否定忽略规则

## 相关资源

- [Git 忽略文件官方文档](https://git-scm.com/docs/gitignore)
- [GitHub 忽略文件模板](https://github.com/github/gitignore)
- [Monorepo 最佳实践](https://monorepo.tools/)

---

**最后更新：** 2025-01-22  
**维护者：** VectorDraw Pro Team